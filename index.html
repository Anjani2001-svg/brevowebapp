<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Brevo Chat Test</title>

  <!-- 1) Setup FIRST -->
  <script>
    window.BrevoConversationsSetup = window.BrevoConversationsSetup || {};

    window.BrevoConversationsSetup.onNewMessage = async function (message) {
      const text = (message && message.text) || (message && message.message && message.message.text);
      const isVisitor = (message && message.type === "visitor") || (message && message.sender === "visitor");
      if (!text || !isVisitor) return;

      try {
        const res = await fetch("https://anjani0123-slcchatbot.hf.space/brevo-webhook", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: { text } })
        });

        const reply = await res.text();
        BrevoConversations("sendAutoMessage", reply);
      } catch (err) {
        BrevoConversations("sendAutoMessage", "Sorry â€” I cannot reply right now.");
      }
    };
  </script>

  <!-- 2) Widget SECOND -->
  <script>
    (function(d, w, c) {
      w.BrevoConversationsID = '695baaa2f5fe81aff600292e';
      w[c] = w[c] || function() { (w[c].q = w[c].q || []).push(arguments); };
      var s = d.createElement('script');
      s.async = true;
      s.src = 'https://conversations-widget.brevo.com/brevo-conversations.js';
      if (d.head) d.head.appendChild(s);
    })(document, window, 'BrevoConversations');
  </script>
</head>

<body>
  <h2>Brevo Chat Test Page</h2>
</body>
</html>

